---
title: "Storytelling with Shiny"
author: "Taylor Kirk"
date: today
format:
  pdf:
    toc: false
    geometry:
      - "left=0.5in"
      - "right=0.5in"
      - "top=0.3in"
      - "bottom=0.3in"
    header-includes:
      - \usepackage{float}
      - \makeatletter 
      - \patchcmd{\@maketitle}{\LARGE}{\small}{}{}
      - \makeatother
      - \vspace{-3cm}
execute:
  echo: false
  warning: false
  message: false
bibliography: references.bib
---

## Part I — Links and Description

-   **Deployed Shiny App URL:** <https://019ab7f1-2a81-e275-5edd-087b0d3fde19.share.connect.posit.cloud/>
-   **Code URL:**
    -   GitHub repository: <https://github.com/tkbarb10/aus-wine-sales.git>

**App Description:**

This Shiny application facilitates the exploration, modeling, and forecasting of Australian wine sales from 1980 through 1994. It enables users to visualize time series decompositions, compare automated versus custom parameter models (ETS, ARIMA, TSLM), and validate accuracy using hold-out sets. These models can then be used to project and compare future sales trends for up to 24 months.

**App Features:**

-   Visualize sales trends across custom date ranges for single or multiple varietals
-   Inspect STL decompositions to isolate trend and seasonal components
-   Set variable forecast horizons (1-5 years) to define training and validation splits
-   Build ETS, ARIMA, or TSLM models using either auto-selection or manual parameter tuning
-   Compare training and validation metrics across all models to assess performance
-   Generate detailed specification reports for individual models
-   Visualize validation performance for up to 4 models against held-out data
-   Forecast future sales for up to 2 years using models refitted to the full data set

## Part II — Data Story

Sales of Fortified wine in Australia suffered a structural decline throughout the 1980s and early 90s. This contrasts sharply with the rising popularity of Dry White and Red varietals, driven by changing consumer tastes and competition from other alcohol types [@boobota_fortified_2025]. This can be easily seen in the time series comparison below of the 3 varietals.

![Fortfied Wine (middle) Compared to Dry White (top) and Red (bottom)](images/time_series.png){width="80%"}

#### Modeling

To quantify this decay, I compared ETS, TSLM, and ARIMA models. A SARIMA(1,1,1)(1,0,1)\[12\] model proved superior.

::: {layout-ncol="2" fig-pos="H"}
![ARIMA Structure](images/arima_specs.png)

![Model Coefficients](images/arima_coeffs.png)
:::

The chosen SARIMA model has one non-seasonal moving average (MA) term, and a seasonal term for autoregressive (AR) and MA. The model also includes a drift term of -80.19, highlighting the decreasing trend in sales.

#### Validation Metric Comparison

![Model Validation Comparison](images/validation.png){width="50%"}

Validating against a 2-year hold-out set (1992–1994), the ARIMA model achieved the lowest RMSE. The ME is negative but small, indicating a slight bias to over-predict. The ETS model shows a large bias to the upside, perhaps indicating it's not capturing the declining trend well.

![Model performance on validation data](images/forecast.png){width="80%"}

We can see from the visuals that ETS and TSLM models perform better over certain time frames (ETS for example captures the change from Nov 1993 to Feb 1994 better than the other two), but the ARIMA model is better able to capture the seasonal trend, leading to lower errors overall.

#### Conclusion

Using the app's Forecast tab to project into 1995, the model predicts Fortified sales will continue to fall. Stakeholders should use this SARIMA drift specification to manage inventory reduction, as simpler seasonal models will likely overestimate future demand.

#### Steps to reproduce above outputs in app

-   **Time Series Comparison**: Explore tab, choose Dry White, Fortified and Red varietals in left sidebar
-   **Model Specs/Report**: Model Building Tab, choose 2 years for forecast horizon (default), the Fortified wine varietal, ARIMA auto (default) and select the model in the report in the sidebar
-   **Validation Comparison**: Build the 3 models in the Building tab, then in the Validation tab, choose the 3 models in the left sidebar and click on Run Validation

## References
